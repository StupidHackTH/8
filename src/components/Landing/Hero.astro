---
import { base } from "../../lib/airtable";

const goalAmount = 100_000;

async function getSponsoredAmount() {
  let amount = 0;
  const records = await base("sponsors").select().all();

  records.forEach((record) => {
    amount += +(record.get("Amount") ?? 0);
  });

  return amount;
}

const progress = ((await getSponsoredAmount()) / goalAmount) * 100;
---

<div
  class="max-w-[930px] w-full h-[400px] flex flex-col sm:flex-row justify-center items-center relative text-center"
>
  <img class="h-full" src="/8/assets/beer.webp" />
  <img class="ml-16 w-[200px] mr-[150px]" src="/8/assets/chat-bubble.webp" />
  <div class="flex flex-col items-centr justfiy-center gap-4">
    <p>our budget progress</p>
    <h2 class="font-advent text-[2rem] sm:text-[3.5rem]">
      {progress.toFixed(2)}%
    </h2>
    <a
      class="text-xl underline mt-auto hover:no-underline"
      href="https://creatorsgarten.org/wiki/Sponsorship/sht8"
      target="_blank"
      rel="noopener noreferrer"
    >
      details for kind person<br />
      to support us
    </a>
  </div>
</div>
